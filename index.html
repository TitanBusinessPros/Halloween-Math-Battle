<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halloween Math Battle</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Creepster', cursive, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        @import url('https://fonts.googleapis.com/css2?family=Creepster&display=swap');

        body {
            background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e);
            color: #ff7518;
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 94, 0, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 60%, rgba(255, 0, 128, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 50% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 20%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            border: 2px solid #ff7518;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M20,20 Q40,5 60,20 T100,20" stroke="%23ff7518" stroke-width="1" fill="none" opacity="0.2"/></svg>');
            background-size: 200px 100px;
            opacity: 0.3;
            z-index: 0;
        }

        h1 {
            font-size: 3.5rem;
            margin-bottom: 10px;
            text-shadow: 3px 3px 0 #000, 5px 5px 10px rgba(255, 117, 24, 0.7);
            color: #ff7518;
            letter-spacing: 2px;
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: #ffcc00;
            text-shadow: 1px 1px 0 #000;
            position: relative;
            z-index: 1;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
            border: 2px solid #ff7518;
        }

        .player-info {
            text-align: center;
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .player1-info {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.4), rgba(178, 34, 34, 0.6));
            border: 2px solid #8b0000;
        }

        .player2-info {
            background: linear-gradient(135deg, rgba(75, 0, 130, 0.4), rgba(106, 90, 205, 0.6));
            border: 2px solid #4b0082;
        }

        .active-player {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }

        .player-name {
            font-size: 1.8rem;
            margin-bottom: 10px;
            font-weight: bold;
            text-shadow: 1px 1px 0 #000;
        }

        .player1-name {
            color: #ff4444;
        }

        .player2-name {
            color: #aa44ff;
        }

        .rockets-count {
            font-size: 1.4rem;
            color: #ffcc00;
            font-weight: bold;
            text-shadow: 1px 1px 0 #000;
        }

        .game-area {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
            height: 500px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
            border: 2px solid #ff7518;
            background-image: 
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M10,10 Q30,5 50,10 T90,10" stroke="%23ff7518" stroke-width="1" fill="none" opacity="0.1"/><path d="M5,50 Q25,45 45,50 T95,50" stroke="%23ff7518" stroke-width="1" fill="none" opacity="0.1"/><path d="M15,90 Q35,85 55,90 T85,90" stroke="%23ff7518" stroke-width="1" fill="none" opacity="0.1"/></svg>');
        }

        .player-area {
            width: 45%;
            height: 100%;
            position: relative;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        .player1-area {
            background: linear-gradient(to bottom, rgba(139, 0, 0, 0.3), rgba(178, 34, 34, 0.5));
            border: 2px solid #8b0000;
        }

        .player2-area {
            background: linear-gradient(to bottom, rgba(75, 0, 130, 0.3), rgba(106, 90, 205, 0.5));
            border: 2px solid #4b0082;
        }

        .base, .monster, .zombie {
            position: absolute;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            transition: all 0.3s;
            filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.7));
        }

        .base {
            width: 100px;
            height: 100px;
            bottom: 20px;
        }

        .player1-base {
            left: 50px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,10 L80,40 L80,80 L20,80 L20,40 Z" fill="%238B0000" stroke="%23550000" stroke-width="3"/><rect x="35" y="50" width="30" height="30" fill="%23550000"/><rect x="40" y="20" width="20" height="20" fill="%238B0000" stroke="%23550000" stroke-width="2"/><circle cx="50" cy="30" r="5" fill="%23FFD700"/></svg>');
        }

        .player2-base {
            right: 50px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,10 L80,40 L80,80 L20,80 L20,40 Z" fill="%234B0082" stroke="%23220044" stroke-width="3"/><rect x="35" y="50" width="30" height="30" fill="%23220044"/><rect x="40" y="20" width="20" height="20" fill="%234B0082" stroke="%23220044" stroke-width="2"/><circle cx="50" cy="30" r="5" fill="%23FFD700"/></svg>');
        }

        .monster {
            width: 80px;
            height: 80px;
            bottom: 130px;
        }

        .player1-monster1 { left: 40px; }
        .player1-monster2 { left: 140px; }
        .player1-monster3 { left: 240px; }

        .player2-monster1 { right: 40px; }
        .player2-monster2 { right: 140px; }
        .player2-monster3 { right: 240px; }

        .zombie {
            width: 60px;
            height: 60px;
            bottom: 220px;
        }

        .player1-zombie1 { left: 20px; }
        .player1-zombie2 { left: 90px; }
        .player1-zombie3 { left: 160px; }
        .player1-zombie4 { left: 230px; }
        .player1-zombie5 { left: 300px; }
        .player1-zombie6 { left: 370px; }
        .player1-zombie7 { left: 440px; }

        .player2-zombie1 { right: 20px; }
        .player2-zombie2 { right: 90px; }
        .player2-zombie3 { right: 160px; }
        .player2-zombie4 { right: 230px; }
        .player2-zombie5 { right: 300px; }
        .player2-zombie6 { right: 370px; }
        .player2-zombie7 { right: 440px; }

        .pumpkin {
            position: absolute;
            width: 40px;
            height: 40px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 10;
            display: none;
            filter: drop-shadow(1px 1px 2px rgba(255, 117, 24, 0.7));
        }

        .player1-pumpkin {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="%23FF7518" stroke="%23CC5500" stroke-width="3"/><circle cx="35" cy="40" r="8" fill="%23000"/><circle cx="65" cy="40" r="8" fill="%23000"/><path d="M35,65 Q50,75 65,65" stroke="%23000" stroke-width="5" fill="none"/><rect x="47" y="15" width="6" height="15" fill="%238B4513"/></svg>');
        }

        .player2-pumpkin {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="%23AA44FF" stroke="%238822CC" stroke-width="3"/><circle cx="35" cy="40" r="8" fill="%23000"/><circle cx="65" cy="40" r="8" fill="%23000"/><path d="M35,65 Q50,75 65,65" stroke="%23000" stroke-width="5" fill="none"/><rect x="47" y="15" width="6" height="15" fill="%238B4513"/></svg>');
        }

        .question-area {
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            border: 2px solid #ff7518;
            position: relative;
            overflow: hidden;
        }

        .question-area::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M10,10 Q40,5 70,10 T90,10" stroke="%23ff7518" stroke-width="1" fill="none" opacity="0.2"/><path d="M5,50 Q35,45 65,50 T95,50" stroke="%23ff7518" stroke-width="1" fill="none" opacity="0.2"/><path d="M15,90 Q45,85 75,90 T85,90" stroke="%23ff7518" stroke-width="1" fill="none" opacity="0.2"/></svg>');
            background-size: 150px 100px;
            opacity: 0.3;
            z-index: 0;
        }

        .question-text {
            font-size: 1.7rem;
            margin-bottom: 15px;
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 1px 1px 0 #000;
            position: relative;
            z-index: 1;
        }

        .timer {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: #ff4444;
            font-weight: bold;
            text-shadow: 1px 1px 0 #000;
            position: relative;
            z-index: 1;
        }

        .answer-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .answer-btn {
            background: linear-gradient(to bottom, #ff7518, #cc5500);
            border: none;
            color: #fff;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3);
            min-width: 80px;
            border: 2px solid #ffcc00;
            font-family: 'Creepster', cursive;
            text-shadow: 1px 1px 0 #000;
        }

        .answer-btn:hover {
            background: linear-gradient(to bottom, #ff8c42, #dd6600);
            transform: translateY(-2px);
            box-shadow: 0 5px 8px rgba(0, 0, 0, 0.4);
        }

        .answer-btn.correct {
            background: linear-gradient(to bottom, #4CAF50, #388E3C);
            border: 2px solid #8BC34A;
        }

        .answer-btn.incorrect {
            background: linear-gradient(to bottom, #F44336, #D32F2F);
            border: 2px solid #FF5252;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }

        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3);
            font-family: 'Creepster', cursive;
            text-shadow: 1px 1px 0 #000;
        }

        .fire-btn {
            background: linear-gradient(to bottom, #ff4444, #cc0000);
            color: #fff;
            border: 2px solid #ffcc00;
        }

        .fire-btn:hover:not(:disabled) {
            background: linear-gradient(to bottom, #ff6666, #dd0000);
            transform: translateY(-2px);
            box-shadow: 0 5px 8px rgba(0, 0, 0, 0.4);
        }

        .fire-btn:disabled {
            background: #555;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            border: 2px solid #777;
        }

        .new-game-btn {
            background: linear-gradient(to bottom, #4caf50, #45a049);
            color: white;
            border: 2px solid #8BC34A;
        }

        .new-game-btn:hover {
            background: linear-gradient(to bottom, #66bb6a, #4caf50);
            transform: translateY(-2px);
            box-shadow: 0 5px 8px rgba(0, 0, 0, 0.4);
        }

        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            display: none;
        }

        .game-over-message {
            font-size: 4rem;
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 3px 3px 0 #000, 5px 5px 10px rgba(255, 117, 24, 0.7);
            color: #ff7518;
            font-family: 'Creepster', cursive;
            letter-spacing: 2px;
        }

        .explosion {
            position: absolute;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #ff9900, #ff0000);
            border-radius: 50%;
            opacity: 0;
            pointer-events: none;
            z-index: 5;
        }

        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        .instructions {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 1rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
            border: 2px solid #ff7518;
        }

        .instructions h3 {
            margin-bottom: 10px;
            color: #ffcc00;
            text-shadow: 1px 1px 0 #000;
            font-size: 1.4rem;
        }

        .instructions p {
            margin-bottom: 5px;
            color: #fff;
        }

        .turn-message {
            text-align: center;
            margin: 10px 0;
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffcc00;
            min-height: 30px;
            text-shadow: 1px 1px 0 #000;
            font-family: 'Creepster', cursive;
            letter-spacing: 1px;
        }

        @media (max-width: 768px) {
            .game-area {
                flex-direction: column;
                height: auto;
            }
            
            .player-area {
                width: 100%;
                height: 200px;
                margin-bottom: 20px;
            }
            
            .answer-options {
                flex-direction: column;
                align-items: center;
            }
            
            .answer-btn {
                width: 80%;
            }
            
            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Halloween Math Battle</h1>
            <p class="subtitle">Solve spooky math problems to earn pumpkin rockets!</p>
        </header>

        <div class="game-info">
            <div class="player-info player1-info" id="player1-info">
                <div class="player-name player1-name">Witch</div>
                <div class="rockets-count">Pumpkin Rockets: <span id="player1-rockets">0</span></div>
            </div>
            <div class="player-info player2-info" id="player2-info">
                <div class="player-name player2-name">Warlock</div>
                <div class="rockets-count">Pumpkin Rockets: <span id="player2-rockets">0</span></div>
            </div>
        </div>

        <div class="turn-message" id="turn-message">Witch's Turn</div>

        <div class="game-area">
            <div class="player-area player1-area">
                <div class="base player1-base" id="player1-base"></div>
                <!-- Monsters -->
                <div class="monster player1-monster1" id="player1-monster1"></div>
                <div class="monster player1-monster2" id="player1-monster2"></div>
                <div class="monster player1-monster3" id="player1-monster3"></div>
                <!-- Zombies -->
                <div class="zombie player1-zombie1" id="player1-zombie1"></div>
                <div class="zombie player1-zombie2" id="player1-zombie2"></div>
                <div class="zombie player1-zombie3" id="player1-zombie3"></div>
                <div class="zombie player1-zombie4" id="player1-zombie4"></div>
                <div class="zombie player1-zombie5" id="player1-zombie5"></div>
                <div class="zombie player1-zombie6" id="player1-zombie6"></div>
                <div class="zombie player1-zombie7" id="player1-zombie7"></div>
            </div>
            <div class="player-area player2-area">
                <div class="base player2-base" id="player2-base"></div>
                <!-- Monsters -->
                <div class="monster player2-monster1" id="player2-monster1"></div>
                <div class="monster player2-monster2" id="player2-monster2"></div>
                <div class="monster player2-monster3" id="player2-monster3"></div>
                <!-- Zombies -->
                <div class="zombie player2-zombie1" id="player2-zombie1"></div>
                <div class="zombie player2-zombie2" id="player2-zombie2"></div>
                <div class="zombie player2-zombie3" id="player2-zombie3"></div>
                <div class="zombie player2-zombie4" id="player2-zombie4"></div>
                <div class="zombie player2-zombie5" id="player2-zombie5"></div>
                <div class="zombie player2-zombie6" id="player2-zombie6"></div>
                <div class="zombie player2-zombie7" id="player2-zombie7"></div>
            </div>
            <!-- Pumpkin elements for both players -->
            <div class="pumpkin player1-pumpkin" id="player1-pumpkin"></div>
            <div class="pumpkin player2-pumpkin" id="player2-pumpkin"></div>
        </div>

        <div class="question-area">
            <div class="question-text" id="question-text">Solve the spooky math problem to earn a pumpkin rocket!</div>
            <div class="timer" id="timer">Time left: 15 seconds</div>
            <div class="answer-options" id="answer-options">
                <!-- Answer buttons will be generated here -->
            </div>
            <div class="controls">
                <button class="fire-btn" id="fire-btn" disabled>Fire Pumpkin!</button>
                <button class="new-game-btn" id="new-game-btn">New Game</button>
            </div>
        </div>

        <div class="instructions">
            <h3>How to Play:</h3>
            <p>1. Answer math questions correctly to earn pumpkin rockets (15 seconds per question)</p>
            <p>2. Click "Fire Pumpkin!" and then click where you want to aim in the opponent's area</p>
            <p>3. If you answer incorrectly or run out of time, you lose your turn</p>
            <p>4. Destroy all of your opponent's haunted house, monsters, and zombies to win! Math made fun by Titan Business Pros LLC!</p>
        </div>

        <div class="game-over" id="game-over">
            <div class="game-over-message" id="game-over-message"></div>
            <button class="new-game-btn" id="restart-btn">Play Again</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Game state
            const gameState = {
                currentPlayer: 1,
                player1: {
                    rockets: 0,
                    base: true,
                    monsters: [true, true, true],
                    zombies: [true, true, true, true, true, true, true]
                },
                player2: {
                    rockets: 0,
                    base: true,
                    monsters: [true, true, true],
                    zombies: [true, true, true, true, true, true, true]
                },
                gameActive: true,
                canFire: false,
                timer: null,
                timeLeft: 15
            };

            // DOM elements
            const questionText = document.getElementById('question-text');
            const answerOptions = document.getElementById('answer-options');
            const fireBtn = document.getElementById('fire-btn');
            const newGameBtn = document.getElementById('new-game-btn');
            const restartBtn = document.getElementById('restart-btn');
            const gameOver = document.getElementById('game-over');
            const gameOverMessage = document.getElementById('game-over-message');
            const player1Pumpkin = document.getElementById('player1-pumpkin');
            const player2Pumpkin = document.getElementById('player2-pumpkin');
            const player1Rockets = document.getElementById('player1-rockets');
            const player2Rockets = document.getElementById('player2-rockets');
            const player1Info = document.getElementById('player1-info');
            const player2Info = document.getElementById('player2-info');
            const turnMessage = document.getElementById('turn-message');
            const timerDisplay = document.getElementById('timer');

            // Halloween-themed monster and zombie SVG designs
            const monsterDesigns = [
                // Monster 1 - Ghost
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,10 Q70,10 85,25 Q100,40 85,55 Q70,70 50,70 Q30,70 15,55 Q0,40 15,25 Q30,10 50,10" fill="%23f0f0f0" stroke="%23c0c0c0" stroke-width="2"/><circle cx="40" cy="40" r="5" fill="%23000"/><circle cx="60" cy="40" r="5" fill="%23000"/><path d="M40,55 Q50,65 60,55" stroke="%23000" stroke-width="3" fill="none"/></svg>',
                
                // Monster 2 - Frankenstein
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect x="30" y="20" width="40" height="50" fill="%2300aa00" stroke="%23006600" stroke-width="2"/><rect x="25" y="70" width="50" height="20" fill="%23006600"/><rect x="30" y="75" width="5" height="15" fill="%23006600"/><rect x="65" y="75" width="5" height="15" fill="%23006600"/><rect x="45" y="80" width="10" height="10" fill="%23006600"/><circle cx="40" cy="40" r="5" fill="%23000"/><circle cx="60" cy="40" r="5" fill="%23000"/><rect x="35" y="50" width="30" height="5" fill="%23000"/><rect x="40" y="15" width="20" height="5" fill="%23006600"/></svg>',
                
                // Monster 3 - Vampire Bat
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,10 L60,20 L70,10 L65,30 L80,35 L65,40 L70,60 L50,50 L30,60 L35,40 L20,35 L35,30 L30,10 L40,20 Z" fill="%23330033" stroke="%23220022" stroke-width="2"/><circle cx="45" cy="35" r="3" fill="%23ff0000"/><circle cx="55" cy="35" r="3" fill="%23ff0000"/></svg>'
            ];

            const zombieDesigns = [
                // Zombie 1 - Classic Zombie
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="40" r="25" fill="%23707070" stroke="%23505050" stroke-width="2"/><circle cx="40" cy="35" r="4" fill="%23000"/><circle cx="60" cy="35" r="4" fill="%23000"/><rect x="40" y="50" width="20" height="8" fill="%23000"/><rect x="40" y="70" width="5" height="25" fill="%23505050"/><rect x="55" y="70" width="5" height="25" fill="%23505050"/></svg>',
                
                // Zombie 2 - Mummy
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="35" r="20" fill="%23f5f5dc" stroke="%23d2b48c" stroke-width="2"/><circle cx="40" cy="30" r="3" fill="%23000"/><circle cx="60" cy="30" r="3" fill="%23000"/><rect x="35" y="45" width="30" height="40" fill="%23f5f5dc"/><line x1="35" y1="45" x2="65" y2="45" stroke="%23d2b48c" stroke-width="2"/><line x1="35" y1="55" x2="65" y2="55" stroke="%23d2b48c" stroke-width="2"/><line x1="35" y1="65" x2="65" y2="65" stroke="%23d2b48c" stroke-width="2"/><line x1="35" y1="75" x2="65" y2="75" stroke="%23d2b48c" stroke-width="2"/></svg>',
                
                // Zombie 3 - Skeleton
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="30" r="20" fill="%23f0f0f0"/><circle cx="40" cy="25" r="3" fill="%23000"/><circle cx="60" cy="25" r="3" fill="%23000"/><rect x="45" y="35" width="10" height="20" fill="%23f0f0f0"/><rect x="35" y="55" width="5" height="20" fill="%23f0f0f0"/><rect x="60" y="55" width="5" height="20" fill="%23f0f0f0"/><rect x="45" y="75" width="5" height="20" fill="%23f0f0f0"/><rect x="55" y="75" width="5" height="20" fill="%23f0f0f0"/></svg>',
                
                // Zombie 4 - Witch
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="40" r="20" fill="%23330033" stroke="%23220022" stroke-width="2"/><path d="M50,10 L70,5 L65,20 L80,25 L65,30 L70,45 L50,35 L30,45 L35,30 L20,25 L35,20 L30,5 Z" fill="%23000"/><rect x="45" y="60" width="10" height="25" fill="%23330033"/></svg>',
                
                // Zombie 5 - Pumpkin Head
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="35" fill="%23ff7518" stroke="%23cc5500" stroke-width="2"/><circle cx="40" cy="40" r="5" fill="%23000"/><circle cx="60" cy="40" r="5" fill="%23000"/><path d="M40,60 Q50,70 60,60" stroke="%23000" stroke-width="3" fill="none"/><rect x="47" y="20" width="6" height="10" fill="%238b4513"/></svg>',
                
                // Zombie 6 - Werewolf
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="40" r="25" fill="%238b4513" stroke="%235d3300" stroke-width="2"/><circle cx="40" cy="35" r="4" fill="%23000"/><circle cx="60" cy="35" r="4" fill="%23000"/><path d="M45,45 L55,45" stroke="%23000" stroke-width="2"/><path d="M40,50 L45,55 L55,55 L60,50" stroke="%23000" stroke-width="2" fill="none"/><rect x="40" y="65" width="5" height="20" fill="%235d3300"/><rect x="55" y="65" width="5" height="20" fill="%235d3300"/></svg>',
                
                // Zombie 7 - Scarecrow
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="35" r="20" fill="%23ffd700" stroke="%23ccac00" stroke-width="2"/><circle cx="40" cy="30" r="3" fill="%23000"/><circle cx="60" cy="30" r="3" fill="%23000"/><path d="M45,40 L55,40" stroke="%23000" stroke-width="2"/><rect x="40" y="55" width="20" height="30" fill="%238b4513"/><rect x="30" y="65" width="10" height="20" fill="%238b4513"/><rect x="60" y="65" width="10" height="20" fill="%238b4513"/></svg>'
            ];

            // Apply monster and zombie designs
            function applyDesigns() {
                // Apply monster designs
                for (let i = 1; i <= 3; i++) {
                    document.getElementById(`player1-monster${i}`).style.backgroundImage = `url('data:image/svg+xml;utf8,${monsterDesigns[i-1]}')`;
                    document.getElementById(`player2-monster${i}`).style.backgroundImage = `url('data:image/svg+xml;utf8,${monsterDesigns[i-1]}')`;
                }
                
                // Apply zombie designs
                for (let i = 1; i <= 7; i++) {
                    document.getElementById(`player1-zombie${i}`).style.backgroundImage = `url('data:image/svg+xml;utf8,${zombieDesigns[i-1]}')`;
                    document.getElementById(`player2-zombie${i}`).style.backgroundImage = `url('data:image/svg+xml;utf8,${zombieDesigns[i-1]}')`;
                }
            }

            // Timer function
            function startTimer() {
                clearInterval(gameState.timer);
                gameState.timeLeft = 15;
                timerDisplay.textContent = `Time left: ${gameState.timeLeft} seconds`;
                
                gameState.timer = setInterval(() => {
                    gameState.timeLeft--;
                    timerDisplay.textContent = `Time left: ${gameState.timeLeft} seconds`;
                    
                    if (gameState.timeLeft <= 0) {
                        clearInterval(gameState.timer);
                        questionText.textContent = "Time's up! You lose your turn.";
                        
                        // Switch turns after a delay
                        setTimeout(() => {
                            if(gameState.gameActive) {
                                gameState.currentPlayer = gameState.currentPlayer === 1 ? 2 : 1;
                                displayQuestion();
                            }
                        }, 2000);
                    }
                }, 1000);
            }

            // Generate a math question
            function generateQuestion() {
                const operations = ['+', '-', '*'];
                const operation = operations[Math.floor(Math.random() * operations.length)];
                
                let num1, num2, answer;
                
                switch(operation) {
                    case '+':
                        num1 = Math.floor(Math.random() * 50) + 1;
                        num2 = Math.floor(Math.random() * 50) + 1;
                        answer = num1 + num2;
                        break;
                    case '-':
                        num1 = Math.floor(Math.random() * 100) + 1;
                        num2 = Math.floor(Math.random() * num1) + 1;
                        answer = num1 - num2;
                        break;
                    case '*':
                        num1 = Math.floor(Math.random() * 12) + 1;
                        num2 = Math.floor(Math.random() * 12) + 1;
                        answer = num1 * num2;
                        break;
                }
                
                const question = `${num1} ${operation} ${num2}`;
                
                // Generate wrong answers
                const answers = [answer];
                while(answers.length < 4) {
                    let wrongAnswer;
                    if(operation === '*') {
                        wrongAnswer = Math.floor(Math.random() * 144) + 1;
                    } else {
                        wrongAnswer = Math.floor(Math.random() * 100) + 1;
                    }
                    
                    if(!answers.includes(wrongAnswer) && wrongAnswer !== answer) {
                        answers.push(wrongAnswer);
                    }
                }
                
                // Shuffle answers
                for(let i = answers.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [answers[i], answers[j]] = [answers[j], answers[i]];
                }
                
                return {
                    question: question,
                    answers: answers,
                    correctAnswer: answer
                };
            }

            // Update active player display
            function updateActivePlayer() {
                if (gameState.currentPlayer === 1) {
                    player1Info.classList.add('active-player');
                    player2Info.classList.remove('active-player');
                    turnMessage.textContent = "Witch's Turn";
                } else {
                    player2Info.classList.add('active-player');
                    player1Info.classList.remove('active-player');
                    turnMessage.textContent = "Warlock's Turn";
                }
            }

            // Display question
            function displayQuestion() {
                updateActivePlayer();
                const questionData = generateQuestion();
                questionText.textContent = `${gameState.currentPlayer === 1 ? 'Witch' : 'Warlock'}: What is ${questionData.question}?`;
                
                answerOptions.innerHTML = '';
                questionData.answers.forEach(answer => {
                    const button = document.createElement('button');
                    button.className = 'answer-btn';
                    button.textContent = answer;
                    button.addEventListener('click', function() {
                        clearInterval(gameState.timer);
                        checkAnswer(answer, questionData.correctAnswer);
                    });
                    answerOptions.appendChild(button);
                });
                
                // Start the timer
                startTimer();
            }

            // Check answer
            function checkAnswer(selectedAnswer, correctAnswer) {
                if(!gameState.gameActive) return;
                
                const buttons = document.querySelectorAll('.answer-btn');
                buttons.forEach(button => {
                    button.disabled = true;
                    if (parseInt(button.textContent) === correctAnswer) {
                        button.classList.add('correct');
                    } else if (parseInt(button.textContent) === parseInt(selectedAnswer)) {
                        button.classList.add('incorrect');
                    }
                });
                
                if(parseInt(selectedAnswer) === correctAnswer) {
                    // Correct answer
                    if(gameState.currentPlayer === 1) {
                        gameState.player1.rockets++;
                        player1Rockets.textContent = gameState.player1.rockets;
                    } else {
                        gameState.player2.rockets++;
                        player2Rockets.textContent = gameState.player2.rockets;
                    }
                    
                    fireBtn.disabled = false;
                    gameState.canFire = true;
                    questionText.textContent = `Correct! You earned a pumpkin rocket. Click "Fire Pumpkin!" then aim and click in the opponent's area.`;
                } else {
                    // Wrong answer - lose turn
                    questionText.textContent = `Incorrect! The answer was ${correctAnswer}. You lose your turn.`;
                    
                    // Switch turns after a delay
                    setTimeout(() => {
                        if(gameState.gameActive) {
                            gameState.currentPlayer = gameState.currentPlayer === 1 ? 2 : 1;
                            displayQuestion();
                        }
                    }, 2000);
                }
            }

            // Fire pumpkin
            function firePumpkin() {
                if(!gameState.canFire || !gameState.gameActive) return;
                
                fireBtn.disabled = true;
                gameState.canFire = false;
                
                // Set up pumpkin firing
                questionText.textContent = `${gameState.currentPlayer === 1 ? 'Witch' : 'Warlock'}: Click in the opponent's area to aim your pumpkin!`;
                
                const opponentArea = gameState.currentPlayer === 1 ? 
                    document.querySelector('.player2-area') : 
                    document.querySelector('.player1-area');
                
                function aimPumpkin(e) {
                    if(!gameState.gameActive) return;
                    
                    const rect = opponentArea.getBoundingClientRect();
                    const gameAreaRect = document.querySelector('.game-area').getBoundingClientRect();
                    
                    // Calculate target position relative to game area
                    const targetX = e.clientX - gameAreaRect.left;
                    const targetY = e.clientY - gameAreaRect.top;
                    
                    // Launch pumpkin animation
                    launchPumpkin(targetX, targetY);
                    
                    // Remove event listener after firing
                    opponentArea.removeEventListener('click', aimPumpkin);
                }
                
                opponentArea.addEventListener('click', aimPumpkin);
            }

            // Launch pumpkin animation
            function launchPumpkin(targetX, targetY) {
                const currentPumpkin = gameState.currentPlayer === 1 ? player1Pumpkin : player2Pumpkin;
                
                // Position pumpkin at the bottom center of the current player's area
                const playerArea = gameState.currentPlayer === 1 ? 
                    document.querySelector('.player1-area') : 
                    document.querySelector('.player2-area');
                    
                const playerRect = playerArea.getBoundingClientRect();
                const gameAreaRect = document.querySelector('.game-area').getBoundingClientRect();
                
                // Calculate the starting position relative to the game area
                const startX = playerRect.left - gameAreaRect.left + playerRect.width / 2;
                const startY = playerRect.bottom - gameAreaRect.top - 20;
                
                // Set pumpkin position and make it visible
                currentPumpkin.style.left = `${startX - 20}px`;
                currentPumpkin.style.top = `${startY - 20}px`;
                currentPumpkin.style.display = 'block';
                
                // Calculate control point for bezier curve (creates arc)
                const controlX = (startX + targetX) / 2;
                const controlY = Math.min(startY, targetY) - 150;
                
                // Animate pumpkin along bezier curve
                let startTime = null;
                const duration = 1500; // ms
                
                function animatePumpkin(timestamp) {
                    if (!startTime) startTime = timestamp;
                    const elapsed = timestamp - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // Bezier curve calculation
                    const x = 
                        Math.pow(1 - progress, 2) * startX + 
                        2 * (1 - progress) * progress * controlX + 
                        Math.pow(progress, 2) * targetX;
                    
                    const y = 
                        Math.pow(1 - progress, 2) * startY + 
                        2 * (1 - progress) * progress * controlY + 
                        Math.pow(progress, 2) * targetY;
                    
                    // Update pumpkin position
                    currentPumpkin.style.left = `${x - 20}px`;
                    currentPumpkin.style.top = `${y - 20}px`;
                    
                    // Add slight rotation for visual effect
                    currentPumpkin.style.transform = `rotate(${progress * 360}deg)`;
                    
                    if (progress < 1) {
                        requestAnimationFrame(animatePumpkin);
                    } else {
                        // Pumpkin reached target
                        currentPumpkin.style.display = 'none';
                        currentPumpkin.style.transform = 'rotate(0deg)';
                        checkHit(targetX, targetY);
                    }
                }
                
                requestAnimationFrame(animatePumpkin);
            }

            // Check if pumpkin hit a target
            function checkHit(x, y) {
                const targetArea = gameState.currentPlayer === 1 ? 
                    document.querySelector('.player2-area') : 
                    document.querySelector('.player1-area');
                    
                // Get all potential targets in the area
                const targets = targetArea.querySelectorAll('.base, .monster, .zombie');
                let hit = false;
                
                targets.forEach(target => {
                    if(target.style.visibility === 'hidden') return;
                    
                    const rect = target.getBoundingClientRect();
                    const areaRect = targetArea.getBoundingClientRect();
                    const gameAreaRect = document.querySelector('.game-area').getBoundingClientRect();
                    
                    // Convert target position relative to the game area
                    const targetX = rect.left - gameAreaRect.left + rect.width / 2;
                    const targetY = rect.top - gameAreaRect.top + rect.height / 2;
                    
                    // Calculate distance between pumpkin impact and target center
                    const distance = Math.sqrt(Math.pow(x - targetX, 2) + Math.pow(y - targetY, 2));
                    
                    // If within hit radius
                    if(distance < 50) {
                        hit = true;
                        destroyTarget(target);
                    }
                });
                
                if(!hit) {
                    questionText.textContent = "Miss! The pumpkin didn't hit anything.";
                }
                
                // Switch turns after a delay
                setTimeout(() => {
                    if(gameState.gameActive) {
                        gameState.currentPlayer = gameState.currentPlayer === 1 ? 2 : 1;
                        displayQuestion();
                    }
                }, 2000);
            }

            // Destroy a target
            function destroyTarget(target) {
                // Create explosion effect
                const explosion = document.createElement('div');
                explosion.className = 'explosion';
                const rect = target.getBoundingClientRect();
                const areaRect = target.parentElement.getBoundingClientRect();
                
                explosion.style.left = `${rect.left - areaRect.left - 40}px`;
                explosion.style.top = `${rect.top - areaRect.top - 40}px`;
                target.parentElement.appendChild(explosion);
                
                // Animate explosion
                explosion.style.animation = 'explode 0.5s forwards';
                
                // Hide target after a delay
                setTimeout(() => {
                    target.style.visibility = 'hidden';
                    explosion.remove();
                    
                    // Update game state
                    const targetId = target.id;
                    const player = targetId.includes('player1') ? 'player1' : 'player2';
                    
                    if(targetId.includes('base')) {
                        gameState[player].base = false;
                        questionText.textContent = "Direct hit! Haunted house destroyed!";
                    } else if(targetId.includes('monster')) {
                        const monsterIndex = parseInt(targetId.slice(-1)) - 1;
                        gameState[player].monsters[monsterIndex] = false;
                        questionText.textContent = "Direct hit! Monster destroyed!";
                    } else if(targetId.includes('zombie')) {
                        const zombieIndex = parseInt(targetId.slice(-1)) - 1;
                        gameState[player].zombies[zombieIndex] = false;
                        questionText.textContent = "Direct hit! Zombie destroyed!";
                    }
                    
                    // Check for win condition
                    checkWinCondition();
                }, 500);
            }

            // Check if a player has won
            function checkWinCondition() {
                const player1Destroyed = !gameState.player1.base && 
                                        gameState.player1.monsters.every(m => !m) && 
                                        gameState.player1.zombies.every(z => !z);
                
                const player2Destroyed = !gameState.player2.base && 
                                        gameState.player2.monsters.every(m => !m) && 
                                        gameState.player2.zombies.every(z => !z);
                
                if(player1Destroyed || player2Destroyed) {
                    gameState.gameActive = false;
                    clearInterval(gameState.timer);
                    
                    if(player1Destroyed && player2Destroyed) {
                        gameOverMessage.textContent = "It's a tie! Both haunted houses were destroyed!";
                    } else if(player1Destroyed) {
                        gameOverMessage.textContent = "Warlock wins!";
                    } else {
                        gameOverMessage.textContent = "Witch wins!";
                    }
                    
                    gameOver.style.display = 'flex';
                }
            }

            // Start a new game
            function newGame() {
                // Reset game state
                gameState.currentPlayer = 1;
                gameState.player1.rockets = 0;
                gameState.player1.base = true;
                gameState.player1.monsters = [true, true, true];
                gameState.player1.zombies = [true, true, true, true, true, true, true];
                
                gameState.player2.rockets = 0;
                gameState.player2.base = true;
                gameState.player2.monsters = [true, true, true];
                gameState.player2.zombies = [true, true, true, true, true, true, true];
                
                gameState.gameActive = true;
                gameState.canFire = false;
                
                // Update UI
                player1Rockets.textContent = '0';
                player2Rockets.textContent = '0';
                
                // Show all targets
                document.querySelectorAll('.base, .monster, .zombie').forEach(target => {
                    target.style.visibility = 'visible';
                });
                
                // Hide pumpkins
                player1Pumpkin.style.display = 'none';
                player2Pumpkin.style.display = 'none';
                
                // Apply designs
                applyDesigns();
                
                // Hide game over screen
                gameOver.style.display = 'none';
                
                // Start with a question
                displayQuestion();
                
                // Disable fire button
                fireBtn.disabled = true;
            }

            // Event listeners
            fireBtn.addEventListener('click', firePumpkin);
            newGameBtn.addEventListener('click', newGame);
            restartBtn.addEventListener('click', newGame);

            // Start the game
            newGame();
        });
    </script>
</body>
</html>
